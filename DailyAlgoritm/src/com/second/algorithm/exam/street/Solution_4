-- write your code in SQLite 3.11.0

select p.name
from (
    select caller, sum(duration) as 'sumAll'
    from calls
    group by (caller)
    union
    select callee, sum(duration)
    from calls
    group by (callee)
) a
join phones p
on p.phone_number = a.caller
group by a.caller
having sum(a.sumAll) >= 10
order by p.name;
